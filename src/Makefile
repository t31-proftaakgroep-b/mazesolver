CXXFLAGS=-Wall -Werror -pedantic -ggdb -O0 -std=c++11 -Isrc -static -pthread
LIBFLAGS=-fPIC -c

SERVER_SOURCES=$(wildcard Server/*.cpp)
SERVER_HEADERS=$(wildcard Server/*.h)

SERVER_OBJECTS=$(SERVER_SOURCES:.cpp=.o)

CLIENT_SOURCES=$(wildcard Client/*.cpp)
CLIENT_HEADERS=$(wildcard Client/*.h)

CLIENT_OBJECTS=$(CLIENT_SOURCES:.cpp=.o)

SCANNER_SOURCES=$(wildcard Scanner/*.cpp)
SCANNER_HEADERS=$(wildcard Scanner/*.h)

SCANNER_OBJECTS=$(SCANNER_SOURCES:.cpp=.o)

PLOTTER_SOURCES=$(wildcard Plotter/*.cpp)
PLOTTER_HEADERS=$(wildcard Plotter/*.h)

PLOTTER_OBJECTS=$(PLOTTER_SOURCES:.cpp=.o)

TCPCLIENT_SOURCES=$(wildcard TCPClient/*.cpp)
TCPCLIENT_HEADERS=$(wildcard TCPClient/*.h)

TCPCLIENT_OBJECTS=$(TCPCLIENT_SOURCES:.cpp=.o)

COMMUNICATION_SOURCES=$(wildcard communication/*.cpp)
COMMUNICATION_HEADERS=$(wildcard communication/*.h)

COMMUNICATION_OBJECTS=$(COMMUNICATION_SOURCES:.cpp=.o)

MAZESOLVER_SOURCES=$(wildcard MazeSolver/*.cpp)
MAZESOLVER_HEADERS=$(wildcard MazeSolver/*.h)

MAZESOLVER_OBJECTS=$(MAZESOLVER_SOURCES:.cpp=.o)

MOTOR_SOURCES=$(wildcard Motor/*.cpp)
MOTOR_HEADERS=$(wildcard Motor/*.h)

MOTOR_OBJECTS=$(MOTOR_SOURCES:.cpp=.o)

PLOTTERPROXY_SOURCES=$(wildcard PlotterProxy/*.cpp)
PLOTTERPROXY_HEADERS=$(wildcard PlotterProxy/*.h)

PLOTTERPROXY_OBJECTS=$(PLOTTERPROXY_SOURCES:.cpp=.o)

PLOTTERSTATEMACHINE_SOURCES=$(wildcard PlotterStatemachine/*.cpp)
PLOTTERSTATEMACHINE_HEADERS=$(wildcard PlotterStatemachine/*.h)

PLOTTERSTATEMACHINE_OBJECTS=$(PLOTTERSTATEMACHINE_SOURCES:.cpp=.o)

SCANNERSTATEMACHINE_SOURCES=$(wildcard ScannerStatemachine/*.cpp)
SCANNERSTATEMACHINE_HEADERS=$(wildcard ScannerStatemachine/*.h)

SCANNERSTATEMACHINE_OBJECTS=$(SCANNERSTATEMACHINE_SOURCES:.cpp=.o)

SCANNERPROXY_SOURCES=$(wildcard ScannerProxy/*.cpp)
SCANNERPROXY_HEADERS=$(wildcard ScannerProxy/*.h)

SCANNERPROXY_OBJECTS=$(SCANNERPROXY_SOURCES:.cpp=.o)

SENSOR_SOURCES=$(wildcard Sensor/*.cpp)
SENSOR_HEADERS=$(wildcard Sensor/*.h)

SENSOR_OBJECTS=$(SENSOR_SOURCES:.cpp=.o)

HEADERS=$(wildcard *.h)

SERVER_TARGET=server
CLIENT_TARGET=client
SCANNER_TARGET=scanner
PLOTTER_TARGET=plotter
TCPCLIENT_TARGET=tcpclient
COMMUNICATION_TARGET=communicationn
MAZESOLVER_TARGET=mazesolver
MOTOR_TARGET=motor
PLOTTERPROXY_TARGET=plotterproxy
PLOTTERSTATEMACHINE_TARGET=plotterstatemachine
SCANNERPROXY_TARGET=scannerproxy
SENSOR_TARGET=sensor
SCANNERSTATEMACHINE_TARGET=scannerstatemachine

CXX=g++

.PHONY: all clean

all: $(SERVER_TARGET) $(CLIENT_TARGET) $(SCANNER_TARGET) $(PLOTTER_TARGET) $(TCPCLIENT_TARGET) $(COMMUNICATION_TARGET) $(MAZESOLVER_TARGET) $(MOTOR_TARGET) $(PLOTTERPROXY_TARGET) $(PLOTTERSTATEMACHINE_TARGET) $(SENSOR_TARGET) $(SCANNERPROXY_TARGET)

$(SERVER_TARGET): $(SERVER_SOURCES) $(SERVER_OBJECTS) $(HEADERS)
	@$(CXX) $(CXXFLAGS) $(CPPFLAGS) -o $@ $(SERVER_SOURCES)

$(CLIENT_TARGET): $(CLIENT_SOURCES) $(CLIENT_OBJECTS) $(HEADERS)
	@$(CXX) $(CXXFLAGS) $(CPPFLAGS) $(LIBFLAGS) -o $@ $(CLIENT_SOURCES)

$(SCANNER_TARGET): $(SCANNER_SOURCES) $(SCANNER_OBJECTS) $(TCPCLIENT_OBJECTS) $(HEADERS)
	@$(CXX) $(CXXFLAGS) $(CPPFLAGS) $(TCPCLIENT_OBJECTS) -o $@ $(SCANNER_SOURCES)

$(PLOTTER_TARGET): $(PLOTTER_SOURCES) $(PLOTTER_OBJECTS) $(CLIENT_OBJECTS) $(HEADERS)
	@$(CXX) $(CXXFLAGS) $(CPPFLAGS) $(TCPCLIENT_OBJECTS) $(CLIENT_OBJECTS) -o $@ $(PLOTTER_SOURCES)

$(TCPCLIENT_TARGET): $(TCPCLIENT_SOURCES) $(TCPCLIENT_OBJECTS) $(HEADERS)
	@$(CXX) $(CXXFLAGS) $(CPPFLAGS) $(LIBFLAGS) -o $@ $(TCPCLIENT_SOURCES)

$(COMMUNICATION_TARGET): $(COMMUNICATION_SOURCES) $(COMMUNICATION_OBJECTS) $(HEADERS)
	@$(CXX) $(CXXFLAGS) $(CPPFLAGS) $(LIBFLAGS) -o $@ $(COMMUNICATION_SOURCES)

$(MAZESOLVER_TARGET): $(MAZESOLVER_SOURCES) $(MAZESOLVER_OBJECTS) $(HEADERS)
	@$(CXX) $(CXXFLAGS) $(CPPFLAGS) $(LIBFLAGS) -o $@ $(MAZESOLVER_SOURCES)

$(MOTOR_TARGET): $(MOTOR_SOURCES) $(MOTOR_OBJECTS) $(HEADERS)
	@$(CXX) $(CXXFLAGS) $(CPPFLAGS) $(LIBFLAGS) -o $@ $(MOTOR_SOURCES)

$(PLOTTERPROXY_TARGET): $(PLOTTERPROXY_SOURCES) $(PLOTTERPROXY_OBJECTS) $(HEADERS)
	@$(CXX) $(CXXFLAGS) $(CPPFLAGS) $(LIBFLAGS) -o $@ $(PLOTTERPROXY_SOURCES)

$(PLOTTERSTATEMACHINE_TARGET): $(PLOTTERSTATEMACHINE_SOURCES) $(PLOTTERSTATEMACHINE_OBJECTS) $(HEADERS)
	@$(CXX) $(CXXFLAGS) $(CPPFLAGS) $(LIBFLAGS) -o $@ $(PLOTTERSTATEMACHINE_SOURCES)

$(SCANNERSTATEMACHINE_TARGET): $(SCANNERSTATEMACHINE_SOURCES) $(SCANNERSTATEMACHINE_OBJECTS) $(HEADERS)
	@$(CXX) $(CXXFLAGS) $(CPPFLAGS) $(LIBFLAGS) -o $@ $(SCANNERSTATEMACHINE_SOURCES)

$(SCANNERPROXY_TARGET): $(SCANNERPROXY_SOURCES) $(SCANNERPROXY_OBJECTS) $(HEADERS)
	@$(CXX) $(CXXFLAGS) $(CPPFLAGS) $(LIBFLAGS) -o $@ $(SCANNERPROXY_SOURCES)

$(SENSOR_TARGET): $(SENSOR_SOURCES) $(SENSOR_OBJECTS) $(HEADERS)
	@$(CXX) $(CXXFLAGS) $(CPPFLAGS) $(LIBFLAGS) -o $@ $(SENSOR_SOURCES)

clean:
	@rm -f $(SERVER_TARGET) $(CLIENT_TARGET) $(SCANNER_TARGET) $(PLOTTER_TARGET) $(TCPCLIENT_TARGET) $(COMMUNICATION_TARGET) $(MAZESOLVER_TARGET) $(MOTOR_TARGET) $(PLOTTERPROXY_TARGET) $(PLOTTERSTATEMACHINE_TARGET) $(SENSOR_TARGET) $(SCANNERPROXY_TARGET) ./*/*.o


